/*C3*/SET SCHEMA PUBLIC
drop table if exists favourite cascade 
drop table if exists image cascade 
drop table if exists offer cascade 
drop table if exists post cascade 
drop table if exists review cascade 
drop table if exists user cascade 
create table favourite (id bigint generated by default as identity, target_id bigint, user_id bigint, primary key (id))
create table image (id bigint generated by default as identity, post_id bigint, data clob, primary key (id))
create table offer (publish_date date, id bigint generated by default as identity, offer bigint, post_id bigint, user_id bigint, primary key (id))
create table post (publish_date date, purchase_date date, buyer_id bigint, id bigint generated by default as identity, seller_id bigint, starting_price bigint, title varchar(255), primary key (id))
create table review (publish_date date, author_id bigint, id bigint generated by default as identity, user_id bigint, content varchar(255), primary key (id))
create table user (registration_date date, finted_coin_balance bigint, id bigint generated by default as identity, email varchar(255) unique, first_name varchar(255), last_name varchar(255), password varchar(255), user_address_city varchar(255), user_address_number varchar(255), user_address_route varchar(255), username varchar(255) unique, primary key (id))
alter table if exists favourite add constraint FKrt80salddi6dkjqd5cryodj3h foreign key (target_id) references user
alter table if exists favourite add constraint FK83lccer6s8bgj5jgjwan5eipk foreign key (user_id) references user
alter table if exists image add constraint FKe2l07hc93u2bbjnl80meu3rn4 foreign key (post_id) references post
alter table if exists offer add constraint FKlbr3ol1p0b5wb3sra7kljhhqt foreign key (post_id) references post
alter table if exists offer add constraint FKo0rdvexlxmyakcvw8b5aqidlk foreign key (user_id) references user
alter table if exists post add constraint FKie9ax41b5pt2s0gcmb28xhcf2 foreign key (buyer_id) references user
alter table if exists post add constraint FK50jwnhnyevk2kxvt29cetcg9h foreign key (seller_id) references user
alter table if exists review add constraint FKhaxvalsvi9mqlu2kq5ev0wgys foreign key (author_id) references user
alter table if exists review add constraint FKiyf57dy48lyiftdrf7y87rnxi foreign key (user_id) references user
INSERT INTO USER VALUES('2023-10-14',500,0,'pierluigitrc@gmail.com','Pierluigi','Trocini','12345678','Rende','166','Malvitani','pierluigiTrc')
COMMIT
INSERT INTO USER VALUES('2023-10-14',500,1,'pietro.macri2000@gmail.com','Pietro','Macr\u00ec','1','Mendicino','166','qualcosa','pit0500')
COMMIT
drop table if exists favourite cascade 
drop table if exists image cascade 
drop table if exists offer cascade 
drop table if exists post cascade 
drop table if exists review cascade 
drop table if exists user cascade 
DISCONNECT
/*C4*/SET SCHEMA PUBLIC
DISCONNECT
/*C5*/SET SCHEMA PUBLIC
DISCONNECT
/*C6*/SET SCHEMA PUBLIC
DISCONNECT
/*C7*/SET SCHEMA PUBLIC
DISCONNECT
/*C8*/SET SCHEMA PUBLIC
DISCONNECT
/*C9*/SET SCHEMA PUBLIC
DISCONNECT
/*C10*/SET SCHEMA PUBLIC
DISCONNECT
/*C11*/SET SCHEMA PUBLIC
DISCONNECT
/*C12*/SET SCHEMA PUBLIC
DISCONNECT
/*C13*/SET SCHEMA PUBLIC
drop table if exists favourite cascade 
drop table if exists image cascade 
drop table if exists offer cascade 
drop table if exists post cascade 
drop table if exists review cascade 
drop table if exists user cascade 
create table favourite (id bigint generated by default as identity, target_id bigint, user_id bigint, primary key (id))
create table image (id bigint generated by default as identity, post_id bigint, data clob, primary key (id))
create table offer (publish_date date, id bigint generated by default as identity, offer bigint, post_id bigint, user_id bigint, primary key (id))
create table post (publish_date date, purchase_date date, buyer_id bigint, id bigint generated by default as identity, seller_id bigint, starting_price bigint, title varchar(255), primary key (id))
create table review (publish_date date, author_id bigint, id bigint generated by default as identity, user_id bigint, content varchar(255), primary key (id))
create table user (registration_date date, finted_coin_balance bigint, id bigint generated by default as identity, email varchar(255) unique, first_name varchar(255), last_name varchar(255), password varchar(255), user_address_city varchar(255), user_address_number varchar(255), user_address_route varchar(255), username varchar(255) unique, primary key (id))
alter table if exists favourite add constraint FKrt80salddi6dkjqd5cryodj3h foreign key (target_id) references user
alter table if exists favourite add constraint FK83lccer6s8bgj5jgjwan5eipk foreign key (user_id) references user
alter table if exists image add constraint FKe2l07hc93u2bbjnl80meu3rn4 foreign key (post_id) references post
alter table if exists offer add constraint FKlbr3ol1p0b5wb3sra7kljhhqt foreign key (post_id) references post
alter table if exists offer add constraint FKo0rdvexlxmyakcvw8b5aqidlk foreign key (user_id) references user
alter table if exists post add constraint FKie9ax41b5pt2s0gcmb28xhcf2 foreign key (buyer_id) references user
alter table if exists post add constraint FK50jwnhnyevk2kxvt29cetcg9h foreign key (seller_id) references user
alter table if exists review add constraint FKhaxvalsvi9mqlu2kq5ev0wgys foreign key (author_id) references user
alter table if exists review add constraint FKiyf57dy48lyiftdrf7y87rnxi foreign key (user_id) references user
INSERT INTO USER VALUES('2023-10-14',500,0,'pierluigitrc@gmail.com','Pierluigi','Trocini','123456789','Rende','166','Malvitani','pierluigiTrc')
COMMIT
